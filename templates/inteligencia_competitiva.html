{% extends "base.html" %}

{% block title %}Inteligencia Competitiva con GenAI - Iberdrola AI{% endblock %}

{% block page_title %}Inteligencia Competitiva con GenAI{% endblock %}

{% block content %}
<!-- Documentation Panel Toggle -->
<button class="doc-panel-toggle" aria-label="Ocultar documentaci√≥n">
    <span class="icon">üìö</span>
    <span>Ocultar Panel</span>
</button>

<!-- Documentation Panel -->
<div class="doc-panel">
    <div class="doc-panel-header">
        <div class="doc-panel-title">
            <h2>üîç Inteligencia Competitiva con GenAI</h2>
            <p>Gu√≠a t√©cnica completa del caso de uso</p>
        </div>
        <div class="doc-panel-header-actions">
            <button class="doc-edit-btn" aria-label="Editar documentaci√≥n">
                <span>‚úèÔ∏è</span> Editar
            </button>
            <button class="doc-panel-close" aria-label="Cerrar">√ó</button>
        </div>
    </div>
    
    <div class="doc-panel-content">
        <!-- Resumen -->
        <section class="doc-section">
            <h3 class="editable-content" contenteditable="false">üéØ Resumen Ejecutivo</h3>
            <p class="editable-content" contenteditable="false">Sistema de Inteligencia Competitiva que combina web scraping, an√°lisis de redes sociales y IA Generativa para monitorizar autom√°ticamente a competidores, detectar nuevas campa√±as y generar propuestas de respuesta en tiempo real.</p>
        </section>

        <!-- Enfoque de IA -->
        <section class="doc-section">
            <h3 class="editable-content" contenteditable="false">ü§ñ Enfoque de IA</h3>
            <p class="editable-content" contenteditable="false"><strong>Modelos Utilizados:</strong> GPT-4 para generaci√≥n de insights y contenido, Vision AI para an√°lisis de creatividades, BERT para an√°lisis de sentimiento en menciones, y algoritmos de web scraping con detecci√≥n de cambios.</p>
        </section>

        <!-- Datos de Entrada -->
        <section class="doc-section">
            <h3 class="editable-content" contenteditable="false">üì• Datos de Entrada</h3>
            <ul>
                <li class="editable-content" contenteditable="false">URLs y contenido de sitios web de competidores</li>
                <li class="editable-content" contenteditable="false">Posts, ads y m√©tricas de redes sociales (Meta, LinkedIn, Twitter)</li>
                <li class="editable-content" contenteditable="false">Comunicados de prensa y noticias del sector energ√©tico</li>
                <li class="editable-content" contenteditable="false">Cambios en precios, tarifas y promociones</li>
                <li class="editable-content" contenteditable="false">Creatividades publicitarias (im√°genes, videos, copy)</li>
                <li class="editable-content" contenteditable="false">Datos hist√≥ricos de campa√±as propias y de competencia</li>
            </ul>
        </section>

        <!-- Procesamiento -->
        <section class="doc-section">
            <h3 class="editable-content" contenteditable="false">‚öôÔ∏è Procesamiento</h3>
            <p class="editable-content" contenteditable="false"><strong>Pipeline de An√°lisis:</strong></p>
            <ol>
                <li class="editable-content" contenteditable="false"><strong>Monitorizaci√≥n Continua:</strong> Scrapers autom√°ticos revisan webs y redes sociales cada hora</li>
                <li class="editable-content" contenteditable="false"><strong>Detecci√≥n de Cambios:</strong> Algoritmos identifican modificaciones significativas (precios, nuevas p√°ginas, posts)</li>
                <li class="editable-content" contenteditable="false"><strong>Clasificaci√≥n:</strong> ML clasifica los cambios por tipo (producto, precio, campa√±a, contenido)</li>
                <li class="editable-content" contenteditable="false"><strong>An√°lisis de Creatividades:</strong> Vision AI extrae elementos visuales, copy, CTA de anuncios</li>
                <li class="editable-content" contenteditable="false"><strong>An√°lisis de Sentimiento:</strong> NLP procesa menciones en redes y reviews de clientes</li>
                <li class="editable-content" contenteditable="false"><strong>Generaci√≥n de Insights:</strong> GPT-4 sintetiza toda la informaci√≥n en informes ejecutivos</li>
                <li class="editable-content" contenteditable="false"><strong>Generaci√≥n de Respuestas:</strong> GenAI crea propuestas de contra-campa√±as con m√∫ltiples variantes</li>
                <li class="editable-content" contenteditable="false"><strong>Optimizaci√≥n:</strong> Algoritmos de predicci√≥n estiman performance de cada variante</li>
            </ol>
        </section>

        <!-- Salidas del Sistema -->
        <section class="doc-section">
            <h3 class="editable-content" contenteditable="false">üì§ Salidas del Sistema</h3>
            <ul>
                <li class="editable-content" contenteditable="false"><strong>Informes Semanales:</strong> Resumen ejecutivo de actividad competitiva</li>
                <li class="editable-content" contenteditable="false"><strong>Alertas en Tiempo Real:</strong> Notificaciones de cambios cr√≠ticos (lanzamientos, bajadas de precio)</li>
                <li class="editable-content" contenteditable="false"><strong>Battle Cards:</strong> Comparativas Iberdrola vs cada competidor actualizadas</li>
                <li class="editable-content" contenteditable="false"><strong>Mensajes de Posicionamiento:</strong> Copy diferenciado por segmento y competidor</li>
                <li class="editable-content" contenteditable="false"><strong>Briefs de Contra-Campa√±as:</strong> Propuestas completas con creatividades, plan de medios y timeline</li>
                <li class="editable-content" contenteditable="false"><strong>Gap Analysis:</strong> Oportunidades de mercado no cubiertas por competencia</li>
                <li class="editable-content" contenteditable="false"><strong>Recomendaciones Accionables:</strong> Sugerencias priorizadas por impacto esperado</li>
            </ul>
        </section>

        <!-- Modelos y Tecnolog√≠as -->
        <section class="doc-section">
            <h3 class="editable-content" contenteditable="false">üîß Modelos y Tecnolog√≠as</h3>
            <div class="tech-stack">
                <span class="tech-badge">GPT-4</span>
                <span class="tech-badge">Claude 3</span>
                <span class="tech-badge">Vision AI</span>
                <span class="tech-badge">BERT Sentiment</span>
                <span class="tech-badge">Scrapy / Selenium</span>
                <span class="tech-badge">BeautifulSoup</span>
                <span class="tech-badge">Meta API</span>
                <span class="tech-badge">Google Ads API</span>
                <span class="tech-badge">Diffbot</span>
                <span class="tech-badge">Change Detection</span>
            </div>
        </section>

        <!-- Por Qu√© es Quick Win -->
        <section class="doc-section">
            <h3 class="editable-content" contenteditable="false">‚ö° Por Qu√© es Quick Win</h3>
            <ul>
                <li class="editable-content" contenteditable="false">‚úÖ <strong>Baja dependencia de datos internos:</strong> Se alimenta principalmente de fuentes p√∫blicas</li>
                <li class="editable-content" contenteditable="false">‚úÖ <strong>APIs disponibles:</strong> Herramientas de scraping y an√°lisis ya existen en el mercado</li>
                <li class="editable-content" contenteditable="false">‚úÖ <strong>Valor inmediato:</strong> Insights desde el primer d√≠a de funcionamiento</li>
                <li class="editable-content" contenteditable="false">‚úÖ <strong>ROI medible:</strong> Reducci√≥n del time-to-market de respuesta a competencia</li>
                <li class="editable-content" contenteditable="false">‚úÖ <strong>Implementaci√≥n modular:</strong> Se puede empezar solo con Intelligence Copilot</li>
                <li class="editable-content" contenteditable="false">‚úÖ <strong>Tecnolog√≠a probada:</strong> Componentes ya validados en otros sectores</li>
            </ul>
        </section>
    </div>
</div>

<div class="use-case-container">
    <!-- Header -->
    <div class="use-case-header">
        <div class="use-case-icon">üîç</div>
        <div class="use-case-title-section">
            <h1 class="use-case-title">Inteligencia Competitiva con GenAI</h1>
            <p class="use-case-subtitle">Monitorizaci√≥n y an√°lisis automatizado de competidores con IA Generativa</p>
        </div>
        <div class="use-case-badge badge-quick-win">‚ö° Quick Win</div>
    </div>

    <!-- Tabs de las 3 ideas -->
    <div class="competitive-tabs">
        <button class="competitive-tab active" onclick="switchCompetitiveTab('copilot')">
            <span class="tab-icon">üìä</span>
            <span class="tab-name">Intelligence Copilot</span>
        </button>
        <button class="competitive-tab" onclick="switchCompetitiveTab('positioning')">
            <span class="tab-icon">üéØ</span>
            <span class="tab-name">Positioning Generator</span>
        </button>
        <button class="competitive-tab" onclick="switchCompetitiveTab('campaign-spy')">
            <span class="tab-icon">üîç</span>
            <span class="tab-name">Campaign Spy & Adapt</span>
        </button>
    </div>

    <!-- TAB 1: Intelligence Copilot -->
    <div id="copilot-tab" class="competitive-tab-content active">
        <div class="card">
            <div class="card-header">
                <h2>üìä Competitive Intelligence Copilot</h2>
                <p>Analista IA aut√≥nomo que monitoriza competidores y genera informes ejecutivos</p>
            </div>
            <div class="card-body">
                <!-- Controles -->
                <div class="demo-controls">
                    <div class="control-group">
                        <label>Selecciona competidores a analizar:</label>
                        <div class="competitor-checkboxes">
                            <label class="checkbox-label">
                                <input type="checkbox" checked> <span class="competitor-logo">‚ö°</span> Endesa
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" checked> <span class="competitor-logo">üî•</span> Naturgy
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" checked> <span class="competitor-logo">üõ¢Ô∏è</span> Repsol
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox"> <span class="competitor-logo">üí°</span> EDP Espa√±a
                            </label>
                        </div>
                    </div>
                    <button class="btn btn-primary" onclick="generateCopilotReport()">
                        ü§ñ Generar Informe Semanal
                    </button>
                </div>

                <!-- Resultado simulado -->
                <div id="copilot-result" class="simulation-result" style="display: none;">
                    <div class="result-header">
                        <h3>üìÑ Informe Competitivo - Semana del 30 Sep 2024</h3>
                        <span class="badge badge-success">Generado por IA</span>
                    </div>

                    <div class="competitor-insights">
                        <!-- Endesa -->
                        <div class="competitor-card">
                            <div class="competitor-header">
                                <span class="competitor-logo-big">‚ö°</span>
                                <h4>Endesa</h4>
                                <span class="activity-badge high">Alta actividad</span>
                            </div>
                            <div class="insight-content">
                                <div class="insight-item">
                                    <span class="insight-icon">üí∞</span>
                                    <div>
                                        <strong>Cambio de Precios:</strong>
                                        <p>Reducci√≥n del 8% en tarifa indexada. Detectado el 28/09.</p>
                                    </div>
                                </div>
                                <div class="insight-item">
                                    <span class="insight-icon">üì¢</span>
                                    <div>
                                        <strong>Nueva Campa√±a:</strong>
                                        <p>"Energ√≠a Sin Sorpresas" - Tarifa plana para pymes. Inversi√≥n estimada: ‚Ç¨1.2M.</p>
                                    </div>
                                </div>
                                <div class="insight-item">
                                    <span class="insight-icon">üì±</span>
                                    <div>
                                        <strong>Social Media:</strong>
                                        <p>+35% engagement en Instagram. Contenido sobre sostenibilidad resuena bien.</p>
                                    </div>
                                </div>
                            </div>
                            <div class="recommendation">
                                <strong>üí° Recomendaci√≥n IA:</strong> Considerar respuesta con oferta de estabilidad de precios para pymes. Su campa√±a est√° ganando tracci√≥n en segmento corporativo.
                            </div>
                        </div>

                        <!-- Naturgy -->
                        <div class="competitor-card">
                            <div class="competitor-header">
                                <span class="competitor-logo-big">üî•</span>
                                <h4>Naturgy</h4>
                                <span class="activity-badge medium">Actividad media</span>
                            </div>
                            <div class="insight-content">
                                <div class="insight-item">
                                    <span class="insight-icon">üå±</span>
                                    <div>
                                        <strong>Nuevo Producto:</strong>
                                        <p>Lanzamiento de "Gas Verde Certificado" para hogares.</p>
                                    </div>
                                </div>
                                <div class="insight-item">
                                    <span class="insight-icon">‚ö†Ô∏è</span>
                                    <div>
                                        <strong>Servicio al Cliente:</strong>
                                        <p>Incremento del 12% en quejas en redes sociales sobre facturaci√≥n.</p>
                                    </div>
                                </div>
                            </div>
                            <div class="recommendation">
                                <strong>üí° Recomendaci√≥n IA:</strong> Oportunidad de capitalizar su problema de servicio al cliente. Comunicar nuestro √≠ndice de satisfacci√≥n superior.
                            </div>
                        </div>

                        <!-- Repsol -->
                        <div class="competitor-card">
                            <div class="competitor-header">
                                <span class="competitor-logo-big">üõ¢Ô∏è</span>
                                <h4>Repsol</h4>
                                <span class="activity-badge low">Actividad baja</span>
                            </div>
                            <div class="insight-content">
                                <div class="insight-item">
                                    <span class="insight-icon">üîå</span>
                                    <div>
                                        <strong>Expansi√≥n:</strong>
                                        <p>Apertura de 15 nuevos puntos de recarga ultrarr√°pida en autopistas.</p>
                                    </div>
                                </div>
                            </div>
                            <div class="recommendation">
                                <strong>üí° Recomendaci√≥n IA:</strong> Monitorear expansi√≥n en electromovilidad. Considerar alianzas estrat√©gicas en este segmento.
                            </div>
                        </div>
                    </div>

                    <!-- Gap Analysis -->
                    <div class="gap-analysis">
                        <h4>üéØ Oportunidades de Mercado Detectadas</h4>
                        <div class="gap-grid">
                            <div class="gap-item">
                                <div class="gap-icon">üíº</div>
                                <strong>Segmento Pymes</strong>
                                <p>Ning√∫n competidor ofrece gesti√≥n energ√©tica integral para pymes. Gap de ‚Ç¨45M.</p>
                            </div>
                            <div class="gap-item">
                                <div class="gap-icon">üè†</div>
                                <strong>Hogar Inteligente</strong>
                                <p>Mercado de dom√≥tica energ√©tica desatendido. Solo el 12% penetraci√≥n.</p>
                            </div>
                            <div class="gap-item">
                                <div class="gap-icon">üìä</div>
                                <strong>Transparencia Tarifaria</strong>
                                <p>Los clientes demandan claridad. Oportunidad de diferenciaci√≥n.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- TAB 2: Positioning Generator -->
    <div id="positioning-tab" class="competitive-tab-content">
        <div class="card">
            <div class="card-header">
                <h2>üéØ Smart Positioning Generator</h2>
                <p>Genera mensajes de posicionamiento diferenciados vs. competencia</p>
            </div>
            <div class="card-body">
                <!-- Controles -->
                <div class="demo-controls">
                    <div class="control-group">
                        <label>Selecciona competidor para analizar:</label>
                        <select id="positioning-competitor" class="form-control">
                            <option value="endesa">‚ö° Endesa</option>
                            <option value="naturgy">üî• Naturgy</option>
                            <option value="repsol">üõ¢Ô∏è Repsol</option>
                        </select>
                    </div>
                    <div class="control-group">
                        <label>Segmento objetivo:</label>
                        <select id="positioning-segment" class="form-control">
                            <option value="hogar">üè† Hogar</option>
                            <option value="pyme">üíº Pyme</option>
                            <option value="empresa">üè¢ Gran Empresa</option>
                        </select>
                    </div>
                    <button class="btn btn-primary" onclick="generatePositioning()">
                        ‚ú® Generar Posicionamiento
                    </button>
                </div>

                <!-- Resultado simulado -->
                <div id="positioning-result" class="simulation-result" style="display: none;">
                    <div class="positioning-comparison">
                        <div class="comparison-column competitor-column">
                            <h4>‚ö° Endesa - Su Posicionamiento</h4>
                            <div class="value-props">
                                <div class="value-prop">
                                    <span class="prop-icon">üí∞</span>
                                    <p><strong>Precio:</strong> "Tarifas competitivas"</p>
                                </div>
                                <div class="value-prop">
                                    <span class="prop-icon">‚ö°</span>
                                    <p><strong>Servicio:</strong> "Energ√≠a estable y segura"</p>
                                </div>
                                <div class="value-prop">
                                    <span class="prop-icon">üì±</span>
                                    <p><strong>Digital:</strong> "App funcional"</p>
                                </div>
                            </div>
                            <div class="weaknesses">
                                <h5>üîç Debilidades detectadas por IA:</h5>
                                <ul>
                                    <li>Mensaje gen√©rico sin diferenciaci√≥n clara</li>
                                    <li>No menciona sostenibilidad</li>
                                    <li>Poca innovaci√≥n percibida</li>
                                </ul>
                            </div>
                        </div>

                        <div class="comparison-column iberdrola-column">
                            <h4>‚ö° Iberdrola - Posicionamiento Generado</h4>
                            <div class="value-props highlighted">
                                <div class="value-prop">
                                    <span class="prop-icon">üå±</span>
                                    <p><strong>Sostenibilidad Real:</strong> "100% energ√≠a verde certificada, no solo palabras"</p>
                                </div>
                                <div class="value-prop">
                                    <span class="prop-icon">ü§ñ</span>
                                    <p><strong>Innovaci√≥n:</strong> "IA que predice y optimiza tu consumo"</p>
                                </div>
                                <div class="value-prop">
                                    <span class="prop-icon">üíé</span>
                                    <p><strong>Transparencia:</strong> "Factura clara, sin letra peque√±a"</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Battle Card -->
                    <div class="battle-card">
                        <h4>‚öîÔ∏è Battle Card: Iberdrola vs Endesa</h4>
                        <div class="battle-grid">
                            <div class="battle-item win">
                                <strong>‚úÖ Ganas en:</strong>
                                <ul>
                                    <li>Sostenibilidad (100% renovable vs 65%)</li>
                                    <li>Innovaci√≥n tecnol√≥gica</li>
                                    <li>Transparencia tarifaria</li>
                                    <li>Experiencia digital superior</li>
                                </ul>
                            </div>
                            <div class="battle-item lose">
                                <strong>‚ö†Ô∏è Ellos tienen ventaja en:</strong>
                                <ul>
                                    <li>Reconocimiento de marca (hist√≥rico)</li>
                                    <li>Cobertura puntos f√≠sicos</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <!-- Mensajes generados -->
                    <div class="generated-messages">
                        <h4>üìù Mensajes de Marketing Generados</h4>
                        <div class="message-variants">
                            <div class="message-card">
                                <div class="message-label">Variante A - Emocional</div>
                                <p class="message-text">"Mientras otros hablan de verde, nosotros lo hacemos. Iberdrola: 100% energ√≠a renovable, 100% transparente, 100% tuya."</p>
                                <div class="message-meta">Para: J√≥venes 25-40, eco-conscientes</div>
                            </div>
                            <div class="message-card">
                                <div class="message-label">Variante B - Racional</div>
                                <p class="message-text">"Compara y comprueba: nuestra energ√≠a es 100% renovable, nuestras tarifas son claras y nuestra IA te ahorra hasta un 25%. Los n√∫meros hablan."</p>
                                <div class="message-meta">Para: Pymes, decisores racionales</div>
                            </div>
                            <div class="message-card">
                                <div class="message-label">Variante C - Innovaci√≥n</div>
                                <p class="message-text">"¬øTu compa√±√≠a el√©ctrica usa IA para optimizar tu factura? La nuestra s√≠. Bienvenido al futuro de la energ√≠a."</p>
                                <div class="message-meta">Para: Early adopters, tech-savvy</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- TAB 3: Campaign Spy & Adapt -->
    <div id="campaign-spy-tab" class="competitive-tab-content">
        <div class="card">
            <div class="card-header">
                <h2>üîç Campaign Spy & Adapt</h2>
                <p>Detecta campa√±as competitivas y genera respuestas automatizadas en <24h</p>
            </div>
            <div class="card-body">
                <!-- Timeline de detecci√≥n -->
                <div class="detection-timeline">
                    <h4>‚è±Ô∏è √öltima Campa√±a Detectada</h4>
                    <div class="timeline-item detected">
                        <div class="timeline-marker">üì°</div>
                        <div class="timeline-content">
                            <span class="timeline-time">Hace 4 horas</span>
                            <p><strong>Campa√±a detectada:</strong> Endesa lanza "Tarifa Plana Verde 2025"</p>
                        </div>
                    </div>
                    <div class="timeline-item analyzed">
                        <div class="timeline-marker">ü§ñ</div>
                        <div class="timeline-content">
                            <span class="timeline-time">Hace 2 horas</span>
                            <p><strong>An√°lisis completado:</strong> IA ha procesado creatividades, mensajes y estrategia</p>
                        </div>
                    </div>
                    <div class="timeline-item generated">
                        <div class="timeline-marker">‚ú®</div>
                        <div class="timeline-content">
                            <span class="timeline-time">Hace 30 min</span>
                            <p><strong>Respuesta generada:</strong> Propuesta de contra-campa√±a lista para revisi√≥n</p>
                        </div>
                    </div>
                </div>

                <button class="btn btn-primary btn-large" onclick="showCampaignAnalysis()">
                    üëÄ Ver An√°lisis Completo y Respuesta
                </button>

                <!-- An√°lisis de campa√±a competitiva -->
                <div id="campaign-analysis" class="simulation-result" style="display: none;">
                    <div class="campaign-detected">
                        <h4>üì¢ Campa√±a Detectada: "Tarifa Plana Verde 2025" - Endesa</h4>
                        <div class="campaign-overview">
                            <div class="campaign-visual">
                                <div class="mock-ad">
                                    <div class="mock-ad-header">‚ö° ENDESA</div>
                                    <div class="mock-ad-content">
                                        <h3>Tarifa Plana Verde</h3>
                                        <p>Paga lo mismo todos los meses</p>
                                        <p class="price">79‚Ç¨/mes*</p>
                                        <button class="mock-btn">Contratar ahora</button>
                                    </div>
                                </div>
                            </div>
                            <div class="campaign-insights">
                                <h5>ü§ñ An√°lisis IA</h5>
                                <div class="insight-grid">
                                    <div class="insight-box">
                                        <strong>üéØ Objetivo:</strong>
                                        <p>Captar clientes preocupados por volatilidad de precios</p>
                                    </div>
                                    <div class="insight-box">
                                        <strong>üë• Audiencia:</strong>
                                        <p>Hogares 30-55 a√±os, ingresos medios-altos</p>
                                    </div>
                                    <div class="insight-box">
                                        <strong>üì± Canales:</strong>
                                        <p>Facebook, Instagram, Google Ads, TV</p>
                                    </div>
                                    <div class="insight-box">
                                        <strong>üí∞ Inversi√≥n estimada:</strong>
                                        <p>‚Ç¨800K - ‚Ç¨1.2M (nacional)</p>
                                    </div>
                                    <div class="insight-box">
                                        <strong>üí™ Fortalezas:</strong>
                                        <p>Mensaje simple, precio visible, verde</p>
                                    </div>
                                    <div class="insight-box">
                                        <strong>‚ö†Ô∏è Debilidades:</strong>
                                        <p>Precio fijo puede ser caro, letra peque√±a</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Propuesta de respuesta -->
                    <div class="response-proposal">
                        <h4>‚ö° Propuesta de Contra-Campa√±a Generada por IA</h4>
                        
                        <div class="proposal-header">
                            <div class="proposal-badge">Recomendada</div>
                            <h5>"Iberdrola Energ√≠a Inteligente: Paga Justo, No Pagues M√°s"</h5>
                        </div>

                        <div class="proposal-content">
                            <div class="proposal-section">
                                <h6>üìù Brief Ejecutivo</h6>
                                <p><strong>Concepto:</strong> Contrastar "tarifa plana" (pagas de m√°s) vs "tarifa inteligente" (pagas lo justo gracias a IA)</p>
                                <p><strong>√Ångulo de Ataque:</strong> No pagues por energ√≠a que no usas. Nuestra IA optimiza tu factura en tiempo real.</p>
                                <p><strong>Tono:</strong> Transparente, educativo, empoderador</p>
                            </div>

                            <div class="proposal-section">
                                <h6>üé® Variantes Creativas</h6>
                                <div class="creative-variants">
                                    <div class="variant-card">
                                        <div class="variant-label">Opci√≥n 1 - Educativa</div>
                                        <div class="mock-ad iberdrola">
                                            <div class="mock-ad-header">‚ö° IBERDROLA</div>
                                            <div class="mock-ad-content">
                                                <h3>¬øTarifa Plana?</h3>
                                                <p>Mejor: Tarifa Inteligente</p>
                                                <p class="highlight">Paga solo lo que consumes<br>+ IA que te ahorra hasta 25%</p>
                                                <button class="mock-btn">Calcula tu ahorro</button>
                                            </div>
                                        </div>
                                        <div class="variant-metrics">
                                            <span>üí∞ CPA estimado: ‚Ç¨28</span>
                                            <span>üìä CTR esperado: 3.2%</span>
                                        </div>
                                    </div>

                                    <div class="variant-card">
                                        <div class="variant-label">Opci√≥n 2 - Comparativa</div>
                                        <div class="mock-ad iberdrola">
                                            <div class="mock-ad-header">‚ö° IBERDROLA</div>
                                            <div class="mock-ad-content">
                                                <h3>Tarifa Plana: 79‚Ç¨</h3>
                                                <h3>Tarifa Inteligente: 52-68‚Ç¨*</h3>
                                                <p class="highlight">¬øPor qu√© pagar m√°s?<br>100% renovable + IA</p>
                                                <button class="mock-btn">Compara y ahorra</button>
                                            </div>
                                        </div>
                                        <div class="variant-metrics">
                                            <span>üí∞ CPA estimado: ‚Ç¨24</span>
                                            <span>üìä CTR esperado: 4.1%</span>
                                        </div>
                                    </div>

                                    <div class="variant-card recommended">
                                        <div class="variant-label">Opci√≥n 3 - Storytelling ‚≠ê</div>
                                        <div class="mock-ad iberdrola">
                                            <div class="mock-ad-header">‚ö° IBERDROLA</div>
                                            <div class="mock-ad-content">
                                                <h3>Energ√≠a que se adapta a ti</h3>
                                                <p>No t√∫ a ella</p>
                                                <p class="highlight">Nuestra IA aprende tus h√°bitos<br>y optimiza tu factura cada mes</p>
                                                <button class="mock-btn">Prueba gratis 3 meses</button>
                                            </div>
                                        </div>
                                        <div class="variant-metrics">
                                            <span>üí∞ CPA estimado: ‚Ç¨22</span>
                                            <span>üìä CTR esperado: 4.8%</span>
                                            <span class="recommended-badge">Recomendada por IA</span>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="proposal-section">
                                <h6>üìç Plan de Medios Recomendado</h6>
                                <table class="media-plan-table">
                                    <thead>
                                        <tr>
                                            <th>Canal</th>
                                            <th>Inversi√≥n</th>
                                            <th>Alcance Est.</th>
                                            <th>Timing</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td>üì± Meta Ads (FB + IG)</td>
                                            <td>‚Ç¨450K</td>
                                            <td>2.8M impresiones</td>
                                            <td>Lanzar en 48h</td>
                                        </tr>
                                        <tr>
                                            <td>üîç Google Ads</td>
                                            <td>‚Ç¨300K</td>
                                            <td>1.5M impresiones</td>
                                            <td>Lanzar en 72h</td>
                                        </tr>
                                        <tr>
                                            <td>üì∫ YouTube</td>
                                            <td>‚Ç¨150K</td>
                                            <td>5M views</td>
                                            <td>Semana 2</td>
                                        </tr>
                                        <tr>
                                            <td>üìß Email Marketing</td>
                                            <td>‚Ç¨20K</td>
                                            <td>850K clientes</td>
                                            <td>Inmediato</td>
                                        </tr>
                                        <tr class="total-row">
                                            <td><strong>TOTAL</strong></td>
                                            <td><strong>‚Ç¨920K</strong></td>
                                            <td><strong>10M+ alcance</strong></td>
                                            <td><strong>30 d√≠as</strong></td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>

                            <div class="proposal-section">
                                <h6>‚è±Ô∏è Timeline de Ejecuci√≥n</h6>
                                <div class="execution-timeline">
                                    <div class="timeline-step">
                                        <div class="step-number">1</div>
                                        <div class="step-content">
                                            <strong>Hoy:</strong> Aprobaci√≥n de creatividades
                                        </div>
                                    </div>
                                    <div class="timeline-step">
                                        <div class="step-number">2</div>
                                        <div class="step-content">
                                            <strong>Ma√±ana:</strong> Producci√≥n final de assets
                                        </div>
                                    </div>
                                    <div class="timeline-step">
                                        <div class="step-number">3</div>
                                        <div class="step-content">
                                            <strong>+48h:</strong> Lanzamiento en Meta y Email
                                        </div>
                                    </div>
                                    <div class="timeline-step">
                                        <div class="step-number">4</div>
                                        <div class="step-content">
                                            <strong>+72h:</strong> Activaci√≥n Google Ads
                                        </div>
                                    </div>
                                    <div class="timeline-step">
                                        <div class="step-number">5</div>
                                        <div class="step-content">
                                            <strong>Semana 2:</strong> Amplificaci√≥n con YouTube
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="proposal-section success-metrics">
                                <h6>üìä KPIs de √âxito Esperados</h6>
                                <div class="kpi-grid">
                                    <div class="kpi-card">
                                        <div class="kpi-value">12,500</div>
                                        <div class="kpi-label">Leads Calificados</div>
                                    </div>
                                    <div class="kpi-card">
                                        <div class="kpi-value">‚Ç¨24</div>
                                        <div class="kpi-label">CPA Objetivo</div>
                                    </div>
                                    <div class="kpi-card">
                                        <div class="kpi-value">4.2%</div>
                                        <div class="kpi-label">CTR Esperado</div>
                                    </div>
                                    <div class="kpi-card">
                                        <div class="kpi-value">8,200</div>
                                        <div class="kpi-label">Conversiones Est.</div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="proposal-actions">
                            <button class="btn btn-primary btn-large">‚úÖ Aprobar y Lanzar Campa√±a</button>
                            <button class="btn btn-secondary">üìù Solicitar Ajustes</button>
                            <button class="btn btn-secondary">üì• Descargar Brief Completo</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
// ==================== STREAMING WORD-BY-WORD EFFECT ====================

function streamText(element, text, speed = 30) {
    return new Promise((resolve) => {
        const originalText = text;
        element.textContent = '';
        element.classList.add('streaming');
        const words = originalText.split(' ');
        let currentIndex = 0;
        
        const interval = setInterval(() => {
            if (currentIndex < words.length) {
                element.textContent += (currentIndex > 0 ? ' ' : '') + words[currentIndex];
                currentIndex++;
            } else {
                clearInterval(interval);
                element.classList.remove('streaming');
                resolve();
            }
        }, speed);
    });
}

function streamHTML(element, htmlContent, speed = 30) {
    return new Promise((resolve) => {
        // Crear un elemento temporal para parsear el HTML
        const temp = document.createElement('div');
        temp.innerHTML = htmlContent;
        
        // Obtener todo el texto
        const text = temp.textContent;
        const words = text.split(' ');
        let currentIndex = 0;
        
        element.textContent = '';
        element.style.opacity = '0.7';
        
        const interval = setInterval(() => {
            if (currentIndex < words.length) {
                element.textContent += (currentIndex > 0 ? ' ' : '') + words[currentIndex];
                currentIndex++;
            } else {
                clearInterval(interval);
                element.style.opacity = '1';
                // Restaurar el HTML completo al final
                element.innerHTML = htmlContent;
                resolve();
            }
        }, speed);
    });
}

async function streamCompetitorCard(card) {
    const insights = card.querySelectorAll('.insight-item p');
    const recommendation = card.querySelector('.recommendation');
    
    for (let insight of insights) {
        const originalText = insight.textContent;
        await streamText(insight, originalText, 25);
    }
    
    if (recommendation) {
        // Buscar todo el texto despu√©s del <strong>
        const fullText = recommendation.textContent;
        const strongText = recommendation.querySelector('strong').textContent;
        const recText = fullText.replace(strongText, '').trim();
        
        if (recText) {
            const textNode = Array.from(recommendation.childNodes).find(node => 
                node.nodeType === Node.TEXT_NODE && node.textContent.trim()
            );
            if (textNode) {
                const span = document.createElement('span');
                span.textContent = textNode.textContent;
                textNode.replaceWith(span);
                await streamText(span, recText, 20);
            }
        }
    }
}

async function streamGapAnalysis() {
    const gapItems = document.querySelectorAll('.gap-item p');
    for (let item of gapItems) {
        const originalText = item.textContent;
        await streamText(item, originalText, 25);
    }
}

function switchCompetitiveTab(tabName) {
    // Ocultar todos los tabs
    document.querySelectorAll('.competitive-tab-content').forEach(tab => {
        tab.classList.remove('active');
    });
    document.querySelectorAll('.competitive-tab').forEach(btn => {
        btn.classList.remove('active');
    });
    
    // Mostrar tab seleccionado
    document.getElementById(tabName + '-tab').classList.add('active');
    event.target.closest('.competitive-tab').classList.add('active');
}

async function generateCopilotReport() {
    const resultDiv = document.getElementById('copilot-result');
    const button = event.target;
    
    // Cambiar bot√≥n a "Generando..."
    button.disabled = true;
    button.innerHTML = '‚è≥ Generando informe con IA...';
    
    // Simular delay inicial
    await new Promise(resolve => setTimeout(resolve, 1500));
    
    // Mostrar resultado
    resultDiv.style.display = 'block';
    resultDiv.scrollIntoView({ behavior: 'smooth', block: 'start' });
    
    // Esperar a que termine el scroll
    await new Promise(resolve => setTimeout(resolve, 500));
    
    // Stream cada tarjeta de competidor
    const competitorCards = resultDiv.querySelectorAll('.competitor-card');
    for (let card of competitorCards) {
        await streamCompetitorCard(card);
    }
    
    // Stream gap analysis
    await streamGapAnalysis();
    
    // Restaurar bot√≥n
    button.disabled = false;
    button.innerHTML = 'ü§ñ Generar Informe Semanal';
}

async function generatePositioning() {
    const resultDiv = document.getElementById('positioning-result');
    const button = event.target;
    
    // Cambiar bot√≥n a "Generando..."
    button.disabled = true;
    button.innerHTML = '‚è≥ Generando posicionamiento con IA...';
    
    // Simular delay inicial
    await new Promise(resolve => setTimeout(resolve, 1500));
    
    // Mostrar resultado
    resultDiv.style.display = 'block';
    resultDiv.scrollIntoView({ behavior: 'smooth', block: 'start' });
    
    await new Promise(resolve => setTimeout(resolve, 500));
    
    // Stream weaknesses
    const weaknesses = resultDiv.querySelectorAll('.weaknesses li');
    for (let weakness of weaknesses) {
        const originalText = weakness.textContent;
        await streamText(weakness, originalText, 30);
    }
    
    // Stream value props de Iberdrola
    const valueProps = resultDiv.querySelectorAll('.iberdrola-column .value-prop p');
    for (let prop of valueProps) {
        const originalText = prop.textContent;
        await streamText(prop, originalText, 25);
    }
    
    // Stream battle items
    const battleItems = resultDiv.querySelectorAll('.battle-item li');
    for (let item of battleItems) {
        const originalText = item.textContent;
        await streamText(item, originalText, 30);
    }
    
    // Stream message variants
    const messages = resultDiv.querySelectorAll('.message-text');
    for (let message of messages) {
        const originalText = message.textContent;
        await streamText(message, originalText, 20);
    }
    
    // Restaurar bot√≥n
    button.disabled = false;
    button.innerHTML = '‚ú® Generar Posicionamiento';
}

async function showCampaignAnalysis() {
    const resultDiv = document.getElementById('campaign-analysis');
    const button = event.target;
    
    // Cambiar bot√≥n a "Analizando..."
    button.disabled = true;
    button.innerHTML = '‚è≥ Analizando campa√±a con IA...';
    
    // Simular delay inicial
    await new Promise(resolve => setTimeout(resolve, 2000));
    
    // Mostrar resultado
    resultDiv.style.display = 'block';
    resultDiv.scrollIntoView({ behavior: 'smooth', block: 'start' });
    
    await new Promise(resolve => setTimeout(resolve, 500));
    
    // Stream insight boxes
    const insightBoxes = resultDiv.querySelectorAll('.insight-box p');
    for (let box of insightBoxes) {
        const originalText = box.textContent;
        await streamText(box, originalText, 30);
    }
    
    // Stream brief ejecutivo
    const briefPs = resultDiv.querySelectorAll('.proposal-section p');
    for (let p of briefPs) {
        const originalText = p.textContent;
        if (originalText.trim().length > 0) {
            await streamText(p, originalText, 25);
        }
    }
    
    // Restaurar bot√≥n
    button.disabled = false;
    button.innerHTML = 'üëÄ Ver An√°lisis Completo y Respuesta';
}
</script>

{% endblock %}

