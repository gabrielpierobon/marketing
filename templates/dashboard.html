{% extends "base.html" %}

{% block title %}Dashboard - Iberdrola AI Marketing Suite{% endblock %}

{% block page_title %}Dashboard Principal{% endblock %}

{% block content %}
<div class="dashboard-container">
    <!-- M√©tricas Principales de Servicios IA -->
    <div class="metrics-grid">
        <div class="metric-card">
            <div class="metric-icon" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">API</div>
            <div class="metric-content">
                <div class="metric-label">Requests API/Mes</div>
                <div class="metric-value">10.5M</div>
                <div class="metric-change positive">+18.3% vs mes anterior</div>
            </div>
        </div>

        <div class="metric-card">
            <div class="metric-icon" style="background: linear-gradient(135deg, #0078D4 0%, #005A9E 100%);">‚ö°</div>
            <div class="metric-content">
                <div class="metric-label">Latencia Promedio</div>
                <div class="metric-value">653ms</div>
                <div class="metric-change positive">-12% vs mes anterior</div>
            </div>
        </div>

        <div class="metric-card">
            <div class="metric-icon" style="background: linear-gradient(135deg, #107C10 0%, #0B5A0B 100%);">‚úì</div>
            <div class="metric-content">
                <div class="metric-label">Uptime Servicios</div>
                <div class="metric-value">99.7%</div>
                <div class="metric-change positive">SLA cumplido</div>
            </div>
        </div>

        <div class="metric-card">
            <div class="metric-icon" style="background: linear-gradient(135deg, #FFB900 0%, #D39D00 100%);">üîå</div>
            <div class="metric-content">
                <div class="metric-label">Integraciones Activas</div>
                <div class="metric-value">18</div>
                <div class="metric-change positive">+3 este mes</div>
            </div>
        </div>
    </div>

    <!-- Estado de Endpoints de IA -->
    <div class="card">
        <div class="card-header">
            <h2>üöÄ Estado de Endpoints de IA</h2>
            <span class="status-badge status-operational">Todos los servicios operativos</span>
        </div>
        <div class="endpoints-status-grid">
            <div class="endpoint-status-card">
                <div class="endpoint-status-header">
                    <div class="endpoint-status-name">
                        <span class="endpoint-icon">üë§</span>
                        <strong>Personalizaci√≥n API</strong>
                    </div>
                    <span class="status-dot status-up"></span>
                </div>
                <div class="endpoint-metrics">
                    <div class="endpoint-metric">
                        <span class="metric-label-small">Requests/mes</span>
                        <span class="metric-value-small">2.45M</span>
                    </div>
                    <div class="endpoint-metric">
                        <span class="metric-label-small">Latencia</span>
                        <span class="metric-value-small">85ms</span>
                    </div>
                    <div class="endpoint-metric">
                        <span class="metric-label-small">Uptime</span>
                        <span class="metric-value-small">99.9%</span>
                    </div>
                </div>
            </div>

            <div class="endpoint-status-card">
                <div class="endpoint-status-header">
                    <div class="endpoint-status-name">
                        <span class="endpoint-icon">üìà</span>
                        <strong>Churn Prediction API</strong>
                    </div>
                    <span class="status-dot status-up"></span>
                </div>
                <div class="endpoint-metrics">
                    <div class="endpoint-metric">
                        <span class="metric-label-small">Requests/mes</span>
                        <span class="metric-value-small">890K</span>
                    </div>
                    <div class="endpoint-metric">
                        <span class="metric-label-small">Latencia</span>
                        <span class="metric-value-small">120ms</span>
                    </div>
                    <div class="endpoint-metric">
                        <span class="metric-label-small">Uptime</span>
                        <span class="metric-value-small">99.8%</span>
                    </div>
                </div>
            </div>

            <div class="endpoint-status-card">
                <div class="endpoint-status-header">
                    <div class="endpoint-status-name">
                        <span class="endpoint-icon">üí¨</span>
                        <strong>Chatbot API</strong>
                    </div>
                    <span class="status-dot status-up"></span>
                </div>
                <div class="endpoint-metrics">
                    <div class="endpoint-metric">
                        <span class="metric-label-small">Requests/mes</span>
                        <span class="metric-value-small">5.6M</span>
                    </div>
                    <div class="endpoint-metric">
                        <span class="metric-label-small">Latencia</span>
                        <span class="metric-value-small">450ms</span>
                    </div>
                    <div class="endpoint-metric">
                        <span class="metric-label-small">Uptime</span>
                        <span class="metric-value-small">99.7%</span>
                    </div>
                </div>
            </div>

            <div class="endpoint-status-card">
                <div class="endpoint-status-header">
                    <div class="endpoint-status-name">
                        <span class="endpoint-icon">‚úçÔ∏è</span>
                        <strong>Content Generation API</strong>
                    </div>
                    <span class="status-dot status-up"></span>
                </div>
                <div class="endpoint-metrics">
                    <div class="endpoint-metric">
                        <span class="metric-label-small">Requests/mes</span>
                        <span class="metric-value-small">145K</span>
                    </div>
                    <div class="endpoint-metric">
                        <span class="metric-label-small">Latencia</span>
                        <span class="metric-value-small">2800ms</span>
                    </div>
                    <div class="endpoint-metric">
                        <span class="metric-label-small">Uptime</span>
                        <span class="metric-value-small">99.5%</span>
                    </div>
                </div>
            </div>

            <div class="endpoint-status-card">
                <div class="endpoint-status-header">
                    <div class="endpoint-status-name">
                        <span class="endpoint-icon">üîç</span>
                        <strong>Segmentation API</strong>
                    </div>
                    <span class="status-dot status-up"></span>
                </div>
                <div class="endpoint-metrics">
                    <div class="endpoint-metric">
                        <span class="metric-label-small">Requests/mes</span>
                        <span class="metric-value-small">450K</span>
                    </div>
                    <div class="endpoint-metric">
                        <span class="metric-label-small">Latencia</span>
                        <span class="metric-value-small">95ms</span>
                    </div>
                    <div class="endpoint-metric">
                        <span class="metric-label-small">Uptime</span>
                        <span class="metric-value-small">99.9%</span>
                    </div>
                </div>
            </div>

            <div class="endpoint-status-card">
                <div class="endpoint-status-header">
                    <div class="endpoint-status-name">
                        <span class="endpoint-icon">üìä</span>
                        <strong>Sentiment Analysis API</strong>
                    </div>
                    <span class="status-dot status-up"></span>
                </div>
                <div class="endpoint-metrics">
                    <div class="endpoint-metric">
                        <span class="metric-label-small">Requests/mes</span>
                        <span class="metric-value-small">1.2M</span>
                    </div>
                    <div class="endpoint-metric">
                        <span class="metric-label-small">Latencia</span>
                        <span class="metric-value-small">180ms</span>
                    </div>
                    <div class="endpoint-metric">
                        <span class="metric-label-small">Uptime</span>
                        <span class="metric-value-small">99.6%</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Contenido Principal -->
    <div class="dashboard-main">
        <!-- Integraciones Activas -->
        <div class="card">
            <div class="card-header">
                <h2>üîå Integraciones Empresariales Activas</h2>
                <a href="{{ url_for('integracion_apis') }}" class="btn btn-secondary btn-sm">Ver Todas</a>
            </div>
            <div class="integraciones-list">
                <div class="integracion-item">
                    <div class="integracion-logo">‚òÅÔ∏è</div>
                    <div class="integracion-info">
                        <div class="integracion-nombre">Salesforce CRM</div>
                        <div class="integracion-desc">3 endpoints conectados ‚Ä¢ 2.8M requests/mes</div>
                    </div>
                    <span class="status-badge-small status-active">Activo</span>
                </div>
                <div class="integracion-item">
                    <div class="integracion-logo">üí¨</div>
                    <div class="integracion-info">
                        <div class="integracion-nombre">WhatsApp Business</div>
                        <div class="integracion-desc">2 endpoints conectados ‚Ä¢ 5.7M requests/mes</div>
                    </div>
                    <span class="status-badge-small status-active">Activo</span>
                </div>
                <div class="integracion-item">
                    <div class="integracion-logo">üé®</div>
                    <div class="integracion-info">
                        <div class="integracion-nombre">Adobe Experience Cloud</div>
                        <div class="integracion-desc">2 endpoints conectados ‚Ä¢ 2.6M requests/mes</div>
                    </div>
                    <span class="status-badge-small status-active">Activo</span>
                </div>
                <div class="integracion-item">
                    <div class="integracion-logo">üìß</div>
                    <div class="integracion-info">
                        <div class="integracion-nombre">Salesforce Marketing Cloud</div>
                        <div class="integracion-desc">3 endpoints conectados ‚Ä¢ 2.9M requests/mes</div>
                    </div>
                    <span class="status-badge-small status-active">Activo</span>
                </div>
            </div>
        </div>

        <!-- Acceso R√°pido a Casos de Uso -->
        <div class="card">
            <div class="card-header">
                <h2>üéØ Casos de Uso IA</h2>
            </div>
            <div class="casos-uso-grid">
                <a href="{{ url_for('personalizacion') }}" class="caso-uso-card">
                    <span class="caso-uso-icon">üë§</span>
                    <div class="caso-uso-info">
                        <span class="caso-uso-title">Personalizaci√≥n</span>
                        <span class="caso-uso-desc">2.45M requests/mes</span>
                    </div>
                </a>
                <a href="{{ url_for('chatbot') }}" class="caso-uso-card">
                    <span class="caso-uso-icon">üí¨</span>
                    <div class="caso-uso-info">
                        <span class="caso-uso-title">Chatbot IA</span>
                        <span class="caso-uso-desc">5.6M requests/mes</span>
                    </div>
                </a>
                <a href="{{ url_for('prediccion_churn') }}" class="caso-uso-card">
                    <span class="caso-uso-icon">üìà</span>
                    <div class="caso-uso-info">
                        <span class="caso-uso-title">Predicci√≥n Churn</span>
                        <span class="caso-uso-desc">890K requests/mes</span>
                    </div>
                </a>
                <a href="{{ url_for('contenido_genai') }}" class="caso-uso-card">
                    <span class="caso-uso-icon">‚úçÔ∏è</span>
                    <div class="caso-uso-info">
                        <span class="caso-uso-title">Contenido GenAI</span>
                        <span class="caso-uso-desc">145K requests/mes</span>
                    </div>
                </a>
                <a href="{{ url_for('segmentacion_avanzada') }}" class="caso-uso-card">
                    <span class="caso-uso-icon">üîç</span>
                    <div class="caso-uso-info">
                        <span class="caso-uso-title">Segmentaci√≥n</span>
                        <span class="caso-uso-desc">450K requests/mes</span>
                    </div>
                </a>
                <a href="{{ url_for('monitorizacion_marca') }}" class="caso-uso-card">
                    <span class="caso-uso-icon">üìä</span>
                    <div class="caso-uso-info">
                        <span class="caso-uso-title">Sentiment Analysis</span>
                        <span class="caso-uso-desc">1.2M requests/mes</span>
                    </div>
                </a>
            </div>
        </div>
    </div>

    <!-- Sidebar Derecho -->
    <div class="dashboard-sidebar">
        <!-- Fuentes de Datos -->
        <div class="card">
            <div class="card-header">
                <h3>üìä Fuentes de Datos</h3>
                <a href="{{ url_for('integracion_datos') }}" class="link-small">Ver todas</a>
            </div>
            <div class="fuentes-stats">
                <div class="fuente-stat-item">
                    <div class="fuente-stat-header">
                        <span class="fuente-stat-icon">‚òÅÔ∏è</span>
                        <span class="fuente-stat-name">Salesforce CRM</span>
                    </div>
                    <div class="fuente-stat-value">2.45M registros</div>
                    <div class="fuente-stat-sync">Sync: Hace 5 min</div>
                </div>
                
                <div class="fuente-stat-item">
                    <div class="fuente-stat-header">
                        <span class="fuente-stat-icon">‚ö°</span>
                        <span class="fuente-stat-name">Smart Meters IoT</span>
                    </div>
                    <div class="fuente-stat-value">15M registros</div>
                    <div class="fuente-stat-sync">Sync: Hace 1 min</div>
                </div>
                
                <div class="fuente-stat-item">
                    <div class="fuente-stat-header">
                        <span class="fuente-stat-icon">üìä</span>
                        <span class="fuente-stat-name">Google Analytics</span>
                    </div>
                    <div class="fuente-stat-value">45M registros</div>
                    <div class="fuente-stat-sync">Sync: Hace 3 min</div>
                </div>
                
                <div class="fuente-stat-item">
                    <div class="fuente-stat-header">
                        <span class="fuente-stat-icon">üí¨</span>
                        <span class="fuente-stat-name">Social Media APIs</span>
                    </div>
                    <div class="fuente-stat-value">2.3M registros</div>
                    <div class="fuente-stat-sync">Sync: Hace 10 min</div>
                </div>
            </div>
        </div>

        <!-- Alertas del Sistema -->
        <div class="card">
            <div class="card-header">
                <h3>üîî Alertas del Sistema</h3>
            </div>
            <div class="alerts-list">
                <div class="alert-item alert-success">
                    <span class="alert-icon">‚úÖ</span>
                    <div class="alert-content">
                        <div class="alert-title">Todos los endpoints operativos</div>
                        <div class="alert-desc">99.7% uptime promedio</div>
                    </div>
                </div>
                <div class="alert-item alert-info">
                    <span class="alert-icon">üîÑ</span>
                    <div class="alert-content">
                        <div class="alert-title">Modelo de Churn actualizado</div>
                        <div class="alert-desc">Precisi√≥n mejorada a 89%</div>
                    </div>
                </div>
                <div class="alert-item alert-warning">
                    <span class="alert-icon">‚ö†Ô∏è</span>
                    <div class="alert-content">
                        <div class="alert-title">Latencia elevada en Content API</div>
                        <div class="alert-desc">2800ms (dentro de SLA)</div>
                    </div>
                </div>
                <div class="alert-item alert-info">
                    <span class="alert-icon">üìà</span>
                    <div class="alert-content">
                        <div class="alert-title">Pico de requests detectado</div>
                        <div class="alert-desc">Chatbot API: +45% vs promedio</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Acceso R√°pido a Integraciones -->
        <div class="card">
            <div class="card-header">
                <h3>‚ö° Acceso R√°pido</h3>
            </div>
            <div class="quick-links">
                <a href="{{ url_for('integracion_datos') }}" class="quick-link">
                    <span class="quick-link-icon">üîå</span>
                    <span class="quick-link-text">Integraci√≥n de Datos</span>
                </a>
                <a href="{{ url_for('integracion_apis') }}" class="quick-link">
                    <span class="quick-link-icon">üîó</span>
                    <span class="quick-link-text">APIs & Conectores</span>
                </a>
                <a href="{{ url_for('configuracion') }}" class="quick-link">
                    <span class="quick-link-icon">‚öôÔ∏è</span>
                    <span class="quick-link-text">Configuraci√≥n</span>
                </a>
            </div>
        </div>
    </div>
</div>

<!-- Incluir Asistente Virtual Fijo -->
{% include 'asistente_panel_fijo.html' %}

{% endblock %}

{% block extra_js %}
<script>
// Animaci√≥n de m√©tricas al cargar
document.addEventListener('DOMContentLoaded', function() {
    const metricValues = document.querySelectorAll('.metric-value');
    metricValues.forEach(el => {
        el.style.opacity = '0';
        el.style.transform = 'translateY(10px)';
        setTimeout(() => {
            el.style.transition = 'all 0.5s ease';
            el.style.opacity = '1';
            el.style.transform = 'translateY(0)';
        }, 100);
    });
});
</script>
{% endblock %}
