{% extends "base.html" %}

{% block content %}
<!-- Panel de Documentaci√≥n -->
<button class="doc-panel-toggle" id="docPanelToggle">
    <span class="toggle-icon">üìö</span>
    <span class="toggle-text">Documentaci√≥n</span>
</button>

<div class="doc-panel" id="docPanel">
    <div class="doc-panel-header">
        <h2 class="doc-panel-title">üìö Optimizaci√≥n Publicitaria Aut√≥noma</h2>
        <button class="doc-edit-btn" id="docEditBtn">‚úèÔ∏è Editar</button>
        <button class="doc-panel-close" id="docPanelClose">√ó</button>
    </div>
    
    <div class="doc-panel-content" id="docPanelContent">
        <!-- Resumen Ejecutivo -->
        <div class="doc-section">
            <h3 class="doc-section-title">
                <span class="icon">üìä</span>
                Resumen Ejecutivo
            </h3>
            <div class="doc-section-content">
                <p>
                    <strong>Optimizaci√≥n Publicitaria Aut√≥noma</strong> utiliza Reinforcement Learning (Q-Learning) 
                    y modelos de forecasting (Prophet) para ajustar autom√°ticamente pujas, presupuestos y targeting 
                    en campa√±as publicitarias. El sistema aprende qu√© combinaciones de par√°metros maximizan conversiones 
                    minimizando coste, aplicando ajustes cada hora bas√°ndose en performance en tiempo real.
                </p>
                
                <p>
                    <strong>Datos de Entrada Procesados:</strong>
                </p>
                <ul>
                    <li><strong>M√©tricas de Campa√±a:</strong> Impresiones, clicks, conversiones, coste, CTR, CVR, CPA, ROAS por hora/d√≠a</li>
                    <li><strong>Datos de Audiencia:</strong> Segmentos, demographics, intereses, comportamientos, performance por segmento</li>
                    <li><strong>Datos de Creativos:</strong> Performance por anuncio, A/B tests, fatiga de creativos</li>
                    <li><strong>Datos Contextuales:</strong> Hora del d√≠a, d√≠a de semana, estacionalidad, eventos, competencia</li>
                    <li><strong>Datos Hist√≥ricos:</strong> Series temporales de performance, patrones estacionales, tendencias</li>
                </ul>
                
                <div class="doc-highlight-box">
                    <strong>üîÑ Pipeline de Optimizaci√≥n</strong><br>
                    Ingesta horaria de datos (APIs de plataformas) ‚Üí Feature engineering ‚Üí Detecci√≥n de anomal√≠as ‚Üí 
                    RL calcula ajustes √≥ptimos de pujas ‚Üí Prophet predice performance futuro ‚Üí Generaci√≥n de recomendaciones ‚Üí 
                    Auto-implementaci√≥n (bajo riesgo) o aprobaci√≥n humana (alto impacto) ‚Üí Monitoreo de resultados
                </div>
                
                <p>
                    <strong>Output del Sistema:</strong>
                </p>
                <ul>
                    <li><strong>Ajustes de Pujas:</strong> Nuevos bid amounts por keyword/audiencia con justificaci√≥n</li>
                    <li><strong>Redistribuci√≥n de Presupuesto:</strong> Reasignaci√≥n entre campa√±as/ad sets basada en performance</li>
                    <li><strong>Recomendaciones de Targeting:</strong> Segmentos a activar/pausar, expansi√≥n de audiencias</li>
                    <li><strong>Alertas de Performance:</strong> Detecci√≥n de ca√≠das an√≥malas, oportunidades de escalado</li>
                    <li><strong>Predicciones:</strong> Forecast de conversiones y coste para pr√≥ximos 7-30 d√≠as</li>
                </ul>
            </div>
        </div>
        
        <!-- Modelos de IA Aplicados -->
        <div class="doc-section">
            <h3 class="doc-section-title">
                <span class="icon">ü§ñ</span>
                Modelos de IA Aplicados
            </h3>
            <div class="doc-section-content">
                <div class="doc-model-card">
                    <h4>1. Reinforcement Learning (Q-Learning)</h4>
                    <p>
                        Algoritmo de aprendizaje por refuerzo que aprende la estrategia √≥ptima de pujas 
                        mediante prueba y error, maximizando el reward (conversiones) mientras minimiza el coste.
                    </p>
                    <p><strong>Uso:</strong> Optimizaci√≥n autom√°tica de pujas en tiempo real</p>
                </div>
                
                <div class="doc-model-card">
                    <h4>2. Prophet (Time Series Forecasting)</h4>
                    <p>
                        Modelo de Facebook para forecasting de series temporales que predice el rendimiento 
                        futuro de campa√±as considerando estacionalidad, tendencias y eventos especiales.
                    </p>
                    <p><strong>Uso:</strong> Predicci√≥n de rendimiento y ajuste de presupuestos</p>
                </div>
                
                <div class="doc-model-card">
                    <h4>3. Random Forest Classifier</h4>
                    <p>
                        Ensemble learning que identifica qu√© combinaciones de keywords, audiencias y creativos 
                        tienen mayor probabilidad de conversi√≥n.
                    </p>
                    <p><strong>Uso:</strong> Identificaci√≥n de segmentos de alto valor</p>
                </div>
                
                <div class="doc-model-card">
                    <h4>4. Anomaly Detection (Isolation Forest)</h4>
                    <p>
                        Detecta autom√°ticamente anomal√≠as en el rendimiento de campa√±as (ca√≠das s√∫bitas de CTR, 
                        picos de CPA) y genera alertas inmediatas.
                    </p>
                    <p><strong>Uso:</strong> Detecci√≥n temprana de problemas</p>
                </div>
            </div>
        </div>
        
        <!-- Arquitectura T√©cnica -->
        <div class="doc-section">
            <h3 class="doc-section-title">
                <span class="icon">üèóÔ∏è</span>
                Arquitectura T√©cnica
            </h3>
            <div class="doc-section-content">
                <div class="doc-tech-stack">
                    <div class="doc-tech-item">
                        <strong>Ad Platforms APIs</strong>
                        <span>Google Ads API, Meta Marketing API, LinkedIn Campaign Manager API</span>
                    </div>
                    <div class="doc-tech-item">
                        <strong>Data Pipeline</strong>
                        <span>Apache Kafka, Azure Data Factory</span>
                    </div>
                    <div class="doc-tech-item">
                        <strong>ML Platform</strong>
                        <span>Azure ML, Python (TensorFlow, scikit-learn)</span>
                    </div>
                    <div class="doc-tech-item">
                        <strong>Orchestration</strong>
                        <span>Apache Airflow, Azure Functions</span>
                    </div>
                </div>
                
                <p><strong>Pipeline de Optimizaci√≥n:</strong></p>
                <ol>
                    <li>
                        <strong>Data Collection (cada hora)</strong><br>
                        Extracci√≥n de m√©tricas de todas las plataformas v√≠a APIs: impresiones, clicks, 
                        conversiones, coste, CTR, CVR, CPA, ROAS.
                    </li>
                    <li>
                        <strong>Feature Engineering</strong><br>
                        C√°lculo de 100+ features: tendencias, ratios, comparaciones con hist√≥rico, 
                        segmentaci√≥n por dispositivo/ubicaci√≥n/hora.
                    </li>
                    <li>
                        <strong>Anomaly Detection</strong><br>
                        Identificaci√≥n de anomal√≠as en rendimiento que requieren intervenci√≥n inmediata.
                    </li>
                    <li>
                        <strong>Optimization Engine</strong><br>
                        Modelos de RL calculan ajustes √≥ptimos de pujas, presupuestos y targeting.
                    </li>
                    <li>
                        <strong>Recommendation Generation</strong><br>
                        Sistema genera recomendaciones priorizadas con impacto estimado.
                    </li>
                    <li>
                        <strong>Auto-Implementation</strong><br>
                        Recomendaciones de bajo riesgo se implementan autom√°ticamente. 
                        Las de alto impacto requieren aprobaci√≥n humana.
                    </li>
                </ol>
            </div>
        </div>
        
        <!-- KPIs y M√©tricas -->
        <div class="doc-section">
            <h3 class="doc-section-title">
                <span class="icon">üìä</span>
                KPIs y M√©tricas de √âxito
            </h3>
            <div class="doc-section-content">
                <p><strong>M√©tricas de Rendimiento:</strong></p>
                <ul>
                    <li><strong>ROAS (Return on Ad Spend):</strong> Revenue / Coste publicitario</li>
                    <li><strong>CPA (Cost per Acquisition):</strong> Coste / Conversiones</li>
                    <li><strong>CTR (Click-Through Rate):</strong> Clicks / Impresiones</li>
                    <li><strong>CVR (Conversion Rate):</strong> Conversiones / Clicks</li>
                    <li><strong>Quality Score:</strong> Puntuaci√≥n de calidad de Google Ads</li>
                </ul>
                
                <p><strong>M√©tricas de Optimizaci√≥n:</strong></p>
                <ul>
                    <li><strong>Optimizaciones Aplicadas:</strong> N√∫mero de ajustes autom√°ticos por d√≠a</li>
                    <li><strong>Tiempo de Respuesta:</strong> Minutos desde detecci√≥n hasta implementaci√≥n</li>
                    <li><strong>Tasa de √âxito:</strong> % de optimizaciones que mejoran rendimiento</li>
                    <li><strong>Ahorro Generado:</strong> Coste evitado mediante optimizaciones</li>
                </ul>
                
                <div class="doc-highlight-box">
                    <strong>üéØ Objetivo de Negocio</strong><br>
                    Aumentar ROAS en 150-200% y reducir CPA en 25-35% mediante optimizaci√≥n autom√°tica 
                    continua, liberando al equipo de marketing para enfocarse en estrategia y creatividad.
                </div>
            </div>
        </div>
    </div>
</div>

<div class="use-case-container">
    <div class="use-case-header">
        <div class="use-case-icon">üéØ</div>
        <div class="use-case-info">
            <h1>Optimizaci√≥n Publicitaria Aut√≥noma</h1>
            <p>Sistema de IA que optimiza autom√°ticamente campa√±as 24/7. Aumenta ROAS +200% y reduce CPA -30%.</p>
        </div>
    </div>

    <!-- M√©tricas Globales -->
    <div class="metrics-grid-optim">
        <div class="metric-card-optim">
            <div class="metric-icon-optim">üìä</div>
            <div class="metric-data">
                <div class="metric-value-optim">{{ metricas.campanas_activas }}</div>
                <div class="metric-label-optim">Campa√±as Activas</div>
            </div>
        </div>
        <div class="metric-card-optim">
            <div class="metric-icon-optim">üí∞</div>
            <div class="metric-data">
                <div class="metric-value-optim">‚Ç¨{{ (metricas.presupuesto_total_mes / 1000)|round(1) }}K</div>
                <div class="metric-label-optim">Presupuesto Mes</div>
            </div>
        </div>
        <div class="metric-card-optim">
            <div class="metric-icon-optim">üéØ</div>
            <div class="metric-data">
                <div class="metric-value-optim">{{ metricas.conversiones_totales|format_number }}</div>
                <div class="metric-label-optim">Conversiones</div>
            </div>
        </div>
        <div class="metric-card-optim">
            <div class="metric-icon-optim">üìà</div>
            <div class="metric-data">
                <div class="metric-value-optim">{{ metricas.roas_promedio }}x</div>
                <div class="metric-label-optim">ROAS Promedio</div>
            </div>
        </div>
    </div>

    <!-- Rendimiento por Plataforma -->
    <div class="card">
        <div class="card-header">
            <h2>üåê Rendimiento por Plataforma</h2>
            <span class="card-subtitle">√öltimos 30 d√≠as</span>
        </div>
        <div class="card-body">
            <div class="plataformas-grid">
                {% for plat in plataformas %}
                <div class="plataforma-card">
                    <div class="plataforma-header">
                        <h3 class="plataforma-nombre">{{ plat.nombre }}</h3>
                        <span class="plataforma-campanas">{{ plat.campanas }} campa√±as</span>
                    </div>
                    <div class="plataforma-stats">
                        <div class="plat-stat">
                            <span class="stat-label">Gasto</span>
                            <span class="stat-value">‚Ç¨{{ (plat.gasto / 1000)|round(1) }}K</span>
                        </div>
                        <div class="plat-stat">
                            <span class="stat-label">Conversiones</span>
                            <span class="stat-value">{{ plat.conversiones }}</span>
                        </div>
                        <div class="plat-stat">
                            <span class="stat-label">ROAS</span>
                            <span class="stat-value">{{ plat.roas }}x</span>
                        </div>
                        <div class="plat-stat">
                            <span class="stat-label">CPA</span>
                            <span class="stat-value">‚Ç¨{{ plat.cpa }}</span>
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>
        </div>
    </div>

    <!-- Recomendaciones de IA -->
    <div class="card">
        <div class="card-header">
            <h2>ü§ñ Recomendaciones de IA</h2>
            <span class="badge badge-warning">{{ recomendaciones|length }} pendientes</span>
        </div>
        <div class="card-body">
            <div class="recomendaciones-list">
                {% for rec in recomendaciones %}
                <div class="recomendacion-item prioridad-{{ rec.prioridad }}">
                    <div class="recomendacion-header">
                        <div class="recomendacion-info">
                            <div class="recomendacion-prioridad">
                                <span class="prioridad-badge prioridad-{{ rec.prioridad }}">
                                    {% if rec.prioridad == 'alta' %}üî¥ Alta
                                    {% elif rec.prioridad == 'media' %}üü° Media
                                    {% else %}üü¢ Baja{% endif %}
                                </span>
                                <span class="recomendacion-tipo">{{ rec.tipo }}</span>
                            </div>
                            <h3 class="recomendacion-titulo">{{ rec.descripcion }}</h3>
                            <p class="recomendacion-campana">Campa√±a: {{ rec.campana_id }}</p>
                        </div>
                        <div class="recomendacion-impacto">
                            {% if rec.impacto_estimado %}
                            <div class="impacto-badge impacto-positivo">
                                {{ rec.impacto_estimado }}
                            </div>
                            {% endif %}
                            {% if rec.ahorro_estimado %}
                            <div class="impacto-badge impacto-ahorro">
                                üí∞ {{ rec.ahorro_estimado }}
                            </div>
                            {% endif %}
                        </div>
                    </div>
                    <div class="recomendacion-accion">
                        <div class="accion-texto">
                            <strong>Acci√≥n:</strong> {{ rec.accion }}
                        </div>
                        <div class="accion-botones">
                            <button class="btn btn-primary" onclick="aplicarRecomendacion('{{ rec.campana_id }}', '{{ rec.tipo }}')">
                                ‚úì Aplicar
                            </button>
                            <button class="btn btn-secondary" onclick="verDetallesRecomendacion('{{ rec.campana_id }}')">
                                üìä Ver Detalles
                            </button>
                            <button class="btn btn-outline" onclick="descartarRecomendacion('{{ rec.campana_id }}')">
                                ‚úï Descartar
                            </button>
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>
        </div>
    </div>

    <!-- Campa√±as Activas -->
    <div class="card">
        <div class="card-header">
            <h2>üìä Campa√±as Activas</h2>
            <button class="btn btn-primary" onclick="crearCampana()">+ Nueva Campa√±a</button>
        </div>
        <div class="card-body" style="padding: 0;">
            <div class="campanas-table-container">
                <table class="campanas-table">
                    <thead>
                        <tr>
                            <th>Campa√±a</th>
                            <th>Plataforma</th>
                            <th>Estado</th>
                            <th>Presupuesto</th>
                            <th>Gasto</th>
                            <th>Impresiones</th>
                            <th>CTR</th>
                            <th>Conversiones</th>
                            <th>CPA</th>
                            <th>ROAS</th>
                            <th>Optimizaciones</th>
                            <th>Acciones</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for camp in campanas %}
                        <tr class="campana-row">
                            <td>
                                <div class="campana-info">
                                    <div class="campana-nombre">{{ camp.nombre }}</div>
                                    <div class="campana-tipo">{{ camp.tipo }}</div>
                                </div>
                            </td>
                            <td>
                                <span class="plataforma-badge plataforma-{{ camp.plataforma|lower|replace(' ', '-') }}">
                                    {{ camp.plataforma }}
                                </span>
                            </td>
                            <td>
                                <span class="estado-badge estado-{{ camp.estado }}">
                                    {% if camp.estado == 'activa' %}‚óè Activa
                                    {% else %}‚óê Revisi√≥n{% endif %}
                                </span>
                            </td>
                            <td>‚Ç¨{{ camp.presupuesto_diario }}/d√≠a</td>
                            <td>‚Ç¨{{ (camp.gasto_actual / 1000)|round(1) }}K</td>
                            <td>{{ (camp.impresiones / 1000)|round(0)|int }}K</td>
                            <td>{{ camp.ctr }}%</td>
                            <td><strong>{{ camp.conversiones }}</strong></td>
                            <td>‚Ç¨{{ camp.cpa }}</td>
                            <td>
                                <span class="roas-badge {% if camp.roas >= 4 %}roas-excelente{% elif camp.roas >= 3 %}roas-bueno{% else %}roas-bajo{% endif %}">
                                    {{ camp.roas }}x
                                </span>
                            </td>
                            <td>
                                <div class="optimizaciones-info">
                                    <span class="optim-count">{{ camp.optimizaciones_aplicadas }}</span>
                                    <span class="optim-time">{{ camp.ultima_optimizacion }}</span>
                                </div>
                            </td>
                            <td>
                                <div class="acciones-cell">
                                    <button class="btn-icon" title="Ver Detalles" onclick="verCampana('{{ camp.id }}')">
                                        üëÅÔ∏è
                                    </button>
                                    <button class="btn-icon" title="Editar" onclick="editarCampana('{{ camp.id }}')">
                                        ‚úèÔ∏è
                                    </button>
                                    <button class="btn-icon" title="Anal√≠ticas" onclick="verAnaliticas('{{ camp.id }}')">
                                        üìä
                                    </button>
                                </div>
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- Historial de Optimizaciones -->
    <div class="card">
        <div class="card-header">
            <h2>üìú Historial de Optimizaciones</h2>
            <span class="badge badge-success">{{ metricas.optimizaciones_aplicadas_mes }} este mes</span>
        </div>
        <div class="card-body">
            <div class="historial-stats">
                <div class="historial-stat">
                    <div class="stat-icon">‚úì</div>
                    <div>
                        <div class="stat-value">{{ metricas.optimizaciones_aplicadas_mes }}</div>
                        <div class="stat-label">Optimizaciones Aplicadas</div>
                    </div>
                </div>
                <div class="historial-stat">
                    <div class="stat-icon">üí∞</div>
                    <div>
                        <div class="stat-value">‚Ç¨{{ (metricas.ahorro_generado_mes / 1000)|round(1) }}K</div>
                        <div class="stat-label">Ahorro Generado</div>
                    </div>
                </div>
                <div class="historial-stat">
                    <div class="stat-icon">‚ö°</div>
                    <div>
                        <div class="stat-value">24/7</div>
                        <div class="stat-label">Monitoreo Activo</div>
                    </div>
                </div>
                <div class="historial-stat">
                    <div class="stat-icon">üéØ</div>
                    <div>
                        <div class="stat-value">94%</div>
                        <div class="stat-label">Tasa de √âxito</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
/* Estilos espec√≠ficos para Optimizaci√≥n Publicitaria */
.metrics-grid-optim {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
    gap: var(--spacing-l);
    margin-bottom: var(--spacing-xl);
}

.metric-card-optim {
    background: var(--neutral-background-1);
    border-radius: var(--border-radius-large);
    padding: var(--spacing-l);
    border: 1px solid var(--neutral-stroke-1);
    display: flex;
    align-items: center;
    gap: var(--spacing-m);
    transition: all var(--duration-fast) var(--curve-easy-ease);
}

.metric-card-optim:hover {
    box-shadow: var(--shadow-8);
    transform: translateY(-2px);
}

.metric-icon-optim {
    font-size: 40px;
}

.metric-value-optim {
    font-size: var(--font-size-700);
    font-weight: var(--font-weight-bold);
    color: var(--neutral-foreground-1);
}

.metric-label-optim {
    font-size: var(--font-size-200);
    color: var(--neutral-foreground-3);
}

/* Plataformas */
.plataformas-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: var(--spacing-l);
}

.plataforma-card {
    background: var(--neutral-background-2);
    border: 1px solid var(--neutral-stroke-1);
    border-radius: var(--border-radius-large);
    padding: var(--spacing-l);
    transition: all var(--duration-fast) var(--curve-easy-ease);
}

.plataforma-card:hover {
    box-shadow: var(--shadow-4);
    transform: translateY(-2px);
}

.plataforma-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: var(--spacing-m);
    padding-bottom: var(--spacing-m);
    border-bottom: 1px solid var(--neutral-stroke-1);
}

.plataforma-nombre {
    font-size: var(--font-size-400);
    font-weight: var(--font-weight-semibold);
    margin: 0;
}

.plataforma-campanas {
    font-size: var(--font-size-200);
    color: var(--neutral-foreground-3);
}

.plataforma-stats {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: var(--spacing-m);
}

.plat-stat {
    display: flex;
    flex-direction: column;
    gap: 4px;
}

/* Recomendaciones */
.recomendaciones-list {
    display: grid;
    gap: var(--spacing-l);
}

.recomendacion-item {
    background: var(--neutral-background-2);
    border-left: 4px solid;
    border-radius: var(--border-radius-large);
    padding: var(--spacing-l);
    transition: all var(--duration-fast) var(--curve-easy-ease);
}

.recomendacion-item.prioridad-alta {
    border-left-color: var(--danger);
}

.recomendacion-item.prioridad-media {
    border-left-color: var(--warning);
}

.recomendacion-item.prioridad-baja {
    border-left-color: var(--success);
}

.recomendacion-item:hover {
    box-shadow: var(--shadow-4);
    transform: translateX(4px);
}

.recomendacion-header {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    margin-bottom: var(--spacing-m);
}

.recomendacion-info {
    flex: 1;
}

.recomendacion-prioridad {
    display: flex;
    gap: var(--spacing-s);
    margin-bottom: var(--spacing-s);
}

.prioridad-badge {
    padding: 4px 12px;
    border-radius: var(--border-radius-small);
    font-size: var(--font-size-100);
    font-weight: var(--font-weight-semibold);
}

.prioridad-badge.prioridad-alta {
    background: var(--danger-light);
    color: var(--danger);
}

.prioridad-badge.prioridad-media {
    background: var(--warning-light);
    color: var(--warning);
}

.prioridad-badge.prioridad-baja {
    background: var(--success-light);
    color: var(--success);
}

.recomendacion-tipo {
    padding: 4px 12px;
    background: var(--primary-light);
    color: var(--primary);
    border-radius: var(--border-radius-small);
    font-size: var(--font-size-100);
    font-weight: var(--font-weight-semibold);
}

.recomendacion-titulo {
    font-size: var(--font-size-400);
    font-weight: var(--font-weight-semibold);
    margin: 0 0 var(--spacing-xs) 0;
}

.recomendacion-campana {
    font-size: var(--font-size-200);
    color: var(--neutral-foreground-3);
    margin: 0;
}

.recomendacion-impacto {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-xs);
}

.impacto-badge {
    padding: var(--spacing-s) var(--spacing-m);
    border-radius: var(--border-radius-medium);
    font-weight: var(--font-weight-semibold);
    text-align: center;
    white-space: nowrap;
}

.impacto-positivo {
    background: var(--success-light);
    color: var(--success);
}

.impacto-ahorro {
    background: var(--primary-light);
    color: var(--primary);
}

.recomendacion-accion {
    padding-top: var(--spacing-m);
    border-top: 1px solid var(--neutral-stroke-1);
}

.accion-texto {
    font-size: var(--font-size-200);
    margin-bottom: var(--spacing-m);
    line-height: 1.6;
}

.accion-botones {
    display: flex;
    gap: var(--spacing-s);
}

/* Tabla de Campa√±as */
.campanas-table-container {
    overflow-x: auto;
}

.campanas-table {
    width: 100%;
    border-collapse: collapse;
}

.campanas-table thead {
    background: var(--neutral-background-2);
}

.campanas-table th {
    padding: var(--spacing-m);
    text-align: left;
    font-size: var(--font-size-200);
    font-weight: var(--font-weight-semibold);
    color: var(--neutral-foreground-2);
    border-bottom: 2px solid var(--neutral-stroke-1);
    white-space: nowrap;
}

.campanas-table td {
    padding: var(--spacing-l) var(--spacing-m);
    border-bottom: 1px solid var(--neutral-stroke-1);
    font-size: var(--font-size-200);
}

.campana-row:hover {
    background: var(--neutral-background-2);
}

.campana-info {
    display: flex;
    flex-direction: column;
    gap: 4px;
}

.campana-nombre {
    font-weight: var(--font-weight-semibold);
    color: var(--neutral-foreground-1);
}

.campana-tipo {
    font-size: var(--font-size-100);
    color: var(--neutral-foreground-3);
}

.plataforma-badge {
    padding: 4px 12px;
    border-radius: var(--border-radius-small);
    font-size: var(--font-size-100);
    font-weight: var(--font-weight-semibold);
    white-space: nowrap;
}

.plataforma-google-ads {
    background: #E6F2FA;
    color: #1A73E8;
}

.plataforma-meta {
    background: #E7F3FF;
    color: #0668E1;
}

.plataforma-linkedin {
    background: #E6F2FA;
    color: #0A66C2;
}

.estado-badge {
    padding: 4px 12px;
    border-radius: var(--border-radius-small);
    font-size: var(--font-size-200);
    font-weight: var(--font-weight-semibold);
    white-space: nowrap;
}

.estado-activa {
    background: var(--success-light);
    color: var(--success);
}

.estado-revision {
    background: var(--warning-light);
    color: var(--warning);
}

.roas-badge {
    padding: 4px 12px;
    border-radius: var(--border-radius-small);
    font-weight: var(--font-weight-bold);
    white-space: nowrap;
}

.roas-excelente {
    background: var(--success-light);
    color: var(--success);
}

.roas-bueno {
    background: var(--warning-light);
    color: var(--warning);
}

.roas-bajo {
    background: var(--danger-light);
    color: var(--danger);
}

.optimizaciones-info {
    display: flex;
    flex-direction: column;
    gap: 4px;
}

.optim-count {
    font-weight: var(--font-weight-semibold);
    color: var(--neutral-foreground-1);
}

.optim-time {
    font-size: var(--font-size-100);
    color: var(--neutral-foreground-3);
}

/* Historial */
.historial-stats {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: var(--spacing-l);
}

.historial-stat {
    display: flex;
    align-items: center;
    gap: var(--spacing-m);
    padding: var(--spacing-l);
    background: var(--neutral-background-2);
    border-radius: var(--border-radius-large);
}

.historial-stat .stat-icon {
    width: 56px;
    height: 56px;
    border-radius: 50%;
    background: var(--primary-light);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 28px;
    flex-shrink: 0;
}

.historial-stat .stat-value {
    font-size: var(--font-size-600);
    font-weight: var(--font-weight-bold);
    color: var(--neutral-foreground-1);
}

.historial-stat .stat-label {
    font-size: var(--font-size-200);
    color: var(--neutral-foreground-3);
}
</style>

{% endblock %}

{% block extra_js %}
<script>
function aplicarRecomendacion(campanaId, tipo) {
    if (confirm(`¬øAplicar recomendaci√≥n de ${tipo} a campa√±a ${campanaId}?`)) {
        alert(`Aplicando optimizaci√≥n...\n\nEn un entorno real, esto:\n\n‚úì Implementar√≠a los cambios v√≠a API\n‚úì Registrar√≠a la optimizaci√≥n\n‚úì Monitorizar√≠a el impacto\n‚úì Generar√≠a reporte de resultados`);
    }
}

function verDetallesRecomendacion(campanaId) {
    alert(`Ver Detalles de Recomendaci√≥n\n\nCampa√±a: ${campanaId}\n\nEn un entorno real, esto mostrar√≠a:\n\n‚úì An√°lisis detallado del problema\n‚úì Datos hist√≥ricos relevantes\n‚úì Simulaci√≥n de impacto\n‚úì Comparaci√≥n con benchmarks`);
}

function descartarRecomendacion(campanaId) {
    if (confirm(`¬øDescartar esta recomendaci√≥n?`)) {
        alert('Recomendaci√≥n descartada. El sistema aprender√° de esta decisi√≥n.');
    }
}

function crearCampana() {
    alert('Crear Nueva Campa√±a\n\nEn un entorno real, esto abrir√≠a un wizard para:\n\n‚úì Seleccionar plataforma\n‚úì Definir objetivo\n‚úì Configurar targeting\n‚úì Establecer presupuesto\n‚úì Crear creativos\n‚úì Programar lanzamiento');
}

function verCampana(campanaId) {
    alert(`Ver Detalles de Campa√±a: ${campanaId}\n\nEn un entorno real, esto mostrar√≠a:\n\n‚úì Dashboard completo de m√©tricas\n‚úì Gr√°ficos de evoluci√≥n temporal\n‚úì An√°lisis de audiencias\n‚úì Rendimiento por dispositivo/ubicaci√≥n\n‚úì Historial de optimizaciones`);
}

function editarCampana(campanaId) {
    alert(`Editar Campa√±a: ${campanaId}\n\nEn un entorno real, esto permitir√≠a:\n\n‚úì Ajustar presupuesto\n‚úì Modificar targeting\n‚úì Actualizar creativos\n‚úì Cambiar estrategia de puja\n‚úì Pausar/reactivar campa√±a`);
}

function verAnaliticas(campanaId) {
    alert(`Anal√≠ticas de Campa√±a: ${campanaId}\n\nEn un entorno real, esto mostrar√≠a:\n\n‚úì An√°lisis de conversiones\n‚úì Funnel de conversi√≥n\n‚úì Segmentaci√≥n de audiencia\n‚úì Comparaci√≥n con competencia\n‚úì Recomendaciones de mejora`);
}
</script>
{% endblock %}